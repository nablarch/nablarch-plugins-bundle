# ES6-Promises

This is a polyfill of [ES6 Promises](https://github.com/domenic/promises-unwrapping). The implementation is basically an API remapping of [rsvp.js](https://github.com/tildeio/rsvp.js).

For API details and how to use promises, see the <a href="http://www.html5rocks.com/en/tutorials/es6/promises/">JavaScript Promises HTML5Rocks article</a>.

## Downloads

* [promise](http://s3.amazonaws.com/es6-promises/promise-0.1.1.js)
* [promise-min](http://s3.amazonaws.com/es6-promises/promise-0.1.1.min.js) (~2k gzipped)

## Node.js

To install:

```sh
npm install es6-promise
```

To use:

```js
var Promise = require('es6-promise').Promise;
```

## Building & Testing

This package uses the [grunt-microlib](https://github.com/thomasboyt/grunt-microlib) package for building.

Custom tasks:

* `grunt test` - Run Mocha tests through Node and PhantomJS.
* `grunt test:phantom` - Run Mocha tests through PhantomJS (browser build).
* `grunt test:node` - Run Mocha tests through Node (CommonJS build).

TODO: docs will output wrong

## Note

[package.json](./package.json)の開発用依存ライブラリに`es6-promise@0.1.1`を定義して [install.bat](../../bin/install.bat)でインストールしようとすると、`es6-promise@0.1.1`のビルドが実行されエラーになる。

そのため、過去にnpm公開されているビルド済のモジュールを事前にダウンロードして、[install.bat](../../bin/install.bat)実行時にビルドがエラーにならないように修正したものを`node_modules`に配置している。

npm公開された`es6-promise@0.1.1`では、ビルドがエラーとなる原因

* [install.bat](../../bin/install.bat)は内部で[installer.js](../../node_modules/nablarch-dev-tool-installer/bin/installer.js)を呼びだし、`npm cache add`を実行する。
* `npm cache add`は公開するときと同様に`prepublish`スクリプトを実行する。
* `es6-promise@0.1.1`は`prepublish`スクリプトでビルド処理が走るように定義している。
* `prepublish`実行時に使用される`Grunt`が正常に動作せずビルドがエラーとなる。