<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="n" uri="http://tis.co.jp/nablarch" %>
<%@ taglib prefix="field" tagdir="/WEB-INF/tags/widget/field" %>
<%@ taglib prefix="button" tagdir="/WEB-INF/tags/widget/button" %>
<%@ taglib prefix="tab" tagdir="/WEB-INF/tags/widget/tab" %>
<%@ taglib prefix="event" tagdir="/WEB-INF/tags/widget/event" %>
<%@ taglib prefix="t" tagdir="/WEB-INF/tags/template" %>
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>

<n:form windowScopePrefixes="formdata">
<event:listen event="#keySelect change">
  <event:confirm message="変更しますか？"></event:confirm>
  <event:send_request name="ajaxSend" uri="ajaxレスポンス.jsp" target="#response" condition="option:selected:is-not-blank"></event:send_request>
</event:listen>

<event:listen event="ajaxSuccess">
   <event:write_to target="#writeToArea" format="{input}"></event:write_to>
</event:listen>
<event:listen event="ajaxError">
   <event:write_to target="#writeToArea" format="errorが発生しました。"></event:write_to>
</event:listen>

  <box:content> 選択肢ない場合はTextAreaの値は変わらない。<br/>error-valueを選択すると例外メッセージになる。 </box:content>
  <field:block title="プルダウンで選択した値をもとにajaxで処理結果を受ける">
    <field:pulldown title="値の選択"
                    id="keySelect"
                    name="formdata.select"
                    listName="selectValues"
                    elementValueProperty="id"
                    elementLabelProperty="value"
                    withNoneOption="true"
                    ></field:pulldown>
    <field:textarea title="サーバ応答" name="formdata.text" id="writeToArea"></field:textarea>
  </field:block>

</n:form>
